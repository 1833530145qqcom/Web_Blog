import{d as y,a0 as T,c as S,X as e,R as a,f as ee,af as u,o as V,a7 as $,V as h,Q as L,U as j,a as p,W as c,M as te,n as K}from"./@vue.a8364f98.js";const ae={key:0},le=["onClick"],oe=["onClick"],se=["onClick"],ne=["onClick"],re={key:1},ie={__name:"TeamUser",setup(ue){const{proxy:i}=ee(),b={loadDataList:"setting/loadUser",saveTeamUser:"setting/saveTeamUser",updateStatus:"setting/updateStatus",delUser:"setting/delUser",updatePassword:"setting/updatePassword"},P=y(i.VueCookies.get("userInfo")||{}),_=T({}),B=[{label:"\u5934\u50CF",prop:"avatar",width:80,scopedSlots:"avatar"},{label:"\u7528\u6237\u4FE1\u606F",prop:"nickName",scopedSlots:"userInfo"},{label:"\u9ED8\u8BA4\u7F16\u8F91\u5668",prop:"editorTypeName",width:150},{label:"\u89D2\u8272",prop:"roleTypeName",scopedSlots:"roleInfo",width:150},{label:"\u72B6\u6001",prop:"statusInfo",scopedSlots:"statusInfo",width:150},{label:"\u65F6\u95F4",prop:"createTime",scopedSlots:"timeInfo",width:300},{label:"\u64CD\u4F5C",prop:"operation",width:250,scopedSlots:"operation"}],k=y({}),M={extHeight:50},v=async()=>{let s={pageNo:k.value.pageNo,pageSize:k.value.pageSize};Object.assign(s,_);let t=await i.Request({url:b.loadDataList,params:s});!t||(k.value=t.data)},O=(s,t,r)=>{t!==o.value.password?r(new Error(s.message)):r()},F={nickName:[{required:!0,message:"\u6635\u79F0\u4E0D\u80FD\u4E3A\u7A7A"}],editorType:[{required:!0,message:"\u8BF7\u9009\u62E9\u9ED8\u8BA4\u7F16\u8F91\u5668"}],password:[{required:!0,message:"\u8BF7\u8F93\u5165\u5BC6\u7801"},{validator:i.Verify.password,message:"\u5BC6\u7801\u6700\u5C118\u4F4D\uFF0C\u53EA\u80FD\u6570\u5B57\u5B57\u6BCD\u548C\u7279\u6B8A\u5B57\u7B26"}],rePassword:[{required:!0,message:"\u8BF7\u518D\u6B21\u8F93\u5165\u5BC6\u7801"},{validator:O,message:"\u4E24\u6B21\u8F93\u5165\u7684\u5BC6\u7801\u4E0D\u4E00\u81F4"}],phone:[{required:!0,message:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7"},{validator:i.Verify.phone,trigger:"blur",message:"\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u624B\u673A\u53F7"}]},f=T({show:!1,title:"\u65B0\u589E\u7528\u6237",buttons:[{type:"danger",text:"\u786E\u5B9A",click:s=>{E()}}]}),o=y({}),x=y(),z=(s,t)=>{f.show=!0,K(async()=>{x.value.resetFields(),s==="add"?(f.edit=!1,f.title="\u65B0\u589E\u8D26\u53F7",o.value={introduction:""}):(f.edit=!0,f.title="\u4FEE\u6539\u8D26\u53F7",Object.assign(o.value,t))})},E=()=>{x.value.validate(async s=>{if(!s)return!1;let t={};Object.assign(t,o.value),delete t.createTime,delete t.lastLoginTime,await i.Request({url:b.saveTeamUser,params:t})&&(f.show=!1,i.Message.success("\u4FDD\u5B58\u6210\u529F"),v())})},A=s=>{let t=s.status==0?1:0,r=s.status==0?"\u542F\u7528":"\u7981\u7528";i.Confirm(`\u4F60\u786E\u5B9A\u8981\u3010${r}\u3011${s.nickName}`,async()=>{!await i.Request({url:b.updateStatus,params:{userId:s.userId,status:t}})||v()})},H=s=>{i.Confirm(`\u4F60\u786E\u5B9A\u8981\u5220\u9664\u3010${s.nickName}\u3011`,async()=>{!await i.Request({url:b.delUser,params:{userId:s.userId}})||v()})},U=y(null),w=T({show:!1,title:"\u4FEE\u6539\u5BC6\u7801",buttons:[{type:"danger",text:"\u786E\u5B9A",click:s=>{W()}}]}),Q=s=>{w.show=!0,K(()=>{U.value.resetFields(),o.value={userId:s}})},W=()=>{U.value.validate(async s=>{if(!s)return;await i.Request({url:b.updatePassword,params:{userId:o.value.userId,password:o.value.password}})||reutrn,w.show=!1,i.Message.success("\u5BC6\u7801\u4FEE\u6539\u6210\u529F")})};return(s,t)=>{const r=u("el-input"),d=u("el-form-item"),m=u("el-col"),R=u("el-button"),g=u("el-row"),C=u("el-form"),X=u("Cover"),I=u("el-divider"),G=u("Table"),q=u("el-radio"),J=u("el-radio-group"),Y=u("cover-upload"),Z=u("editor-html"),D=u("Dialog");return V(),S("div",null,[e(C,{model:_},{default:a(()=>[e(g,null,{default:a(()=>[e(m,{span:4},{default:a(()=>[e(d,{label:"\u6635\u79F0",prop:"nickName","label-width":"50px"},{default:a(()=>[e(r,{placeholder:"\u8BF7\u8F93\u5165\u6635\u79F0",modelValue:_.nickNameFuzzy,"onUpdate:modelValue":t[0]||(t[0]=l=>_.nickNameFuzzy=l),clearable:"",onKeyup:$(v,["enter","native"])},null,8,["modelValue","onKeyup"])]),_:1})]),_:1}),e(m,{span:4},{default:a(()=>[e(d,{label:"\u624B\u673A\u53F7",prop:"phone","label-width":"80px"},{default:a(()=>[e(r,{placeholder:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7",modelValue:_.phoneFuzzy,"onUpdate:modelValue":t[1]||(t[1]=l=>_.phoneFuzzy=l),clearable:"",onKeyup:$(v,["enter","native"])},null,8,["modelValue","onKeyup"])]),_:1})]),_:1}),e(m,{span:5,style:{"padding-left":"10px"}},{default:a(()=>[e(R,{type:"danger",onClick:v},{default:a(()=>[h("\u641C\u7D22")]),_:1}),P.value.roleType==1?(V(),L(R,{key:0,type:"danger",onClick:t[2]||(t[2]=l=>z("add"))},{default:a(()=>[h("\u65B0\u589E\u6210\u5458")]),_:1})):j("",!0)]),_:1})]),_:1})]),_:1},8,["model"]),e(G,{columns:B,showPagination:!0,dataSource:k.value,fetch:v,options:M},{avatar:a(({index:l,row:n})=>[e(X,{cover:n.avatar},null,8,["cover"])]),userInfo:a(({index:l,row:n})=>[p("div",null,"\u6635\xA0\xA0\xA0\xA0\u79F0\uFF1A"+c(n.nickName),1),p("div",null,"\u624B\u673A\u53F7\uFF1A"+c(n.phone),1),p("div",null,"\u804C\xA0\xA0\xA0\xA0\u4E1A\uFF1A"+c(n.profession),1)]),roleInfo:a(({index:l,row:n})=>[p("div",null,c(n.roleTypeName),1)]),statusInfo:a(({index:l,row:n})=>[p("div",null,[p("span",{style:te({color:n.status==1?"green":"red"})},c(n.statusName),5)])]),timeInfo:a(({index:l,row:n})=>[p("div",null,"\u521B\u5EFA\u65F6\u95F4\uFF1A"+c(n.createTime),1),p("div",null,"\u6700\u540E\u767B\u5F55\u65F6\u95F4\uFF1A"+c(n.lastLoginTime),1)]),operation:a(({index:l,row:n})=>[P.value.roleType==1?(V(),S("span",ae,[p("a",{href:"javascript:void(0)",onClick:N=>z("edit",n),class:"a-link"},"\u4FEE\u6539",8,le),e(I,{direction:"vertical"}),p("a",{href:"javascript:void(0)",class:"a-link",onClick:N=>A(n)},c(n.status==0?"\u542F\u7528":"\u7981\u7528"),9,oe),e(I,{direction:"vertical"}),p("a",{href:"javascript:void(0)",class:"a-link",onClick:N=>Q(n.userId)},"\u4FEE\u6539\u5BC6\u7801",8,se),e(I,{direction:"vertical"}),p("a",{href:"javascript:void(0)",class:"a-link",onClick:N=>H(n)},"\u5220\u9664",8,ne)])):(V(),S("span",re,"--"))]),_:1},8,["dataSource"]),e(D,{show:f.show,title:f.title,buttons:f.buttons,width:"50%",onClose:t[11]||(t[11]=l=>f.show=!1)},{default:a(()=>[e(C,{ref_key:"editFormRef",ref:x,model:o.value,rules:F,"label-width":"110px"},{default:a(()=>[e(g,{gutter:10},{default:a(()=>[e(m,{span:12},{default:a(()=>[e(d,{label:"\u6635\u79F0",prop:"nickName"},{default:a(()=>[e(r,{maxLength:30,modelValue:o.value.nickName,"onUpdate:modelValue":t[3]||(t[3]=l=>o.value.nickName=l)},null,8,["modelValue"])]),_:1})]),_:1}),e(m,{span:12},{default:a(()=>[e(d,{label:"\u624B\u673A\u53F7",prop:"phone"},{default:a(()=>[e(r,{maxLength:11,modelValue:o.value.phone,"onUpdate:modelValue":t[4]||(t[4]=l=>o.value.phone=l)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),o.value.userId==null?(V(),L(g,{key:0,gutter:10},{default:a(()=>[e(m,{span:12},{default:a(()=>[e(d,{label:"\u5BC6\u7801",prop:"password"},{default:a(()=>[e(r,{modelValue:o.value.password,"onUpdate:modelValue":t[5]||(t[5]=l=>o.value.password=l),maxLength:20,type:"password"},null,8,["modelValue"])]),_:1})]),_:1}),e(m,{span:12},{default:a(()=>[e(d,{label:"\u518D\u6B21\u8F93\u5165\u5BC6\u7801",prop:"rePassword"},{default:a(()=>[e(r,{modelValue:o.value.rePassword,"onUpdate:modelValue":t[6]||(t[6]=l=>o.value.rePassword=l),maxLength:20,type:"password"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})):j("",!0),e(g,{gutter:10},{default:a(()=>[e(m,{span:12},{default:a(()=>[e(d,{label:"\u9ED8\u8BA4\u7F16\u8F91\u5668",prop:"editorType"},{default:a(()=>[e(J,{modelValue:o.value.editorType,"onUpdate:modelValue":t[7]||(t[7]=l=>o.value.editorType=l)},{default:a(()=>[e(q,{label:1},{default:a(()=>[h("Markdown\u7F16\u8F91\u5668")]),_:1}),e(q,{label:0},{default:a(()=>[h("\u5BCC\u6587\u672C\u7F16\u8F91\u5668")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(m,{span:12},{default:a(()=>[e(d,{label:"\u804C\u4E1A",prop:"profession"},{default:a(()=>[e(r,{modelValue:o.value.profession,"onUpdate:modelValue":t[8]||(t[8]=l=>o.value.profession=l)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(g,{gutter:10},{default:a(()=>[e(m,{span:24},{default:a(()=>[e(d,{label:"\u5934\u50CF",prop:"avatar"},{default:a(()=>[e(Y,{modelValue:o.value.avatar,"onUpdate:modelValue":t[9]||(t[9]=l=>o.value.avatar=l)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(g,{gutter:10},{default:a(()=>[e(m,{span:24},{default:a(()=>[e(d,{label:"\u7B80\u4ECB",prop:"introduction"},{default:a(()=>[e(Z,{id:"introduction",ref:"introduction",height:300,modelValue:o.value.introduction,"onUpdate:modelValue":t[10]||(t[10]=l=>o.value.introduction=l)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["show","title","buttons"]),e(D,{show:w.show,title:w.title,buttons:w.buttons,width:"400px",onClose:t[14]||(t[14]=l=>w.show=!1)},{default:a(()=>[e(C,{model:o.value,rules:F,ref_key:"passwordFormRef",ref:U,"label-width":"80px"},{default:a(()=>[e(d,{label:"\u5BC6\u7801",prop:"password"},{default:a(()=>[e(r,{placeholder:"\u8BF7\u8F93\u5165\u5BC6\u7801",type:"password",modelValue:o.value.password,"onUpdate:modelValue":t[12]||(t[12]=l=>o.value.password=l)},null,8,["modelValue"])]),_:1}),e(d,{label:"\u91CD\u590D\u5BC6\u7801",prop:"rePassword"},{default:a(()=>[e(r,{placeholder:"\u8BF7\u518D\u6B21\u8F93\u5165\u5BC6\u7801",type:"password",modelValue:o.value.rePassword,"onUpdate:modelValue":t[13]||(t[13]=l=>o.value.rePassword=l)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["show","title","buttons"])])}}};export{ie as default};
