import{d as h,a0 as N,c as L,Q as O,R as i,U as z,X as a,a8 as E,f as F,n as J,af as s,o as S,V as M,a as d,L as B}from"./@vue.a8364f98.js";const A={class:"op"},H=["onClick"],P=["onClick"],Q=["onClick"],X=["onClick"],W={__name:"BlogCategory",setup(G){const{proxy:r}=F(),p={loadDataList:"/category/loadAllCategory4Blog",saveCategory:"/category/saveCategory4Blog",delCategory:"category/delCategory4Blog",changeSort:"category/changeCategorySort4Blog"},w=h(r.VueCookies.get("userInfo")||{}),R=[{label:"\u5C01\u9762",prop:"cover",width:100,scopedSlots:"cover"},{label:"\u540D\u79F0",prop:"categoryName",width:200},{label:"\u7B80\u4ECB",prop:"categoryDesc"},{label:"\u535A\u5BA2\u6570\u91CF",prop:"blogCount",width:100},{label:"\u64CD\u4F5C",prop:"op",width:200,scopedSlots:"op"}],m=N({}),T={extHeight:10},v=async()=>{let t=await r.Request({url:p.loadDataList});!t||(m.list=t.data)},n=N({show:!1,title:"\u6807\u9898",buttons:[{type:"danger",text:"\u786E\u5B9A",click:t=>{j()}}]}),l=h({}),$={categoryName:[{required:!0,message:"\u8BF7\u8F93\u5165\u5206\u7C7B\u540D\u79F0"}]},f=h(),b=(t,e)=>{n.show=!0,J(()=>{f.value.resetFields(),t=="add"?(n.title="\u65B0\u589E\u5206\u7C7B",l.value={}):t=="update"&&(n.title="\u7F16\u8F91\u5206\u7C7B",l.value=JSON.parse(JSON.stringify(e)))})},j=()=>{f.value.validate(async t=>{if(!t)return;let e={};Object.assign(e,l.value),await r.Request({url:p.saveCategory,params:e})&&(n.show=!1,r.Message.success("\u4FDD\u5B58\u6210\u529F"),v())})},x=t=>{r.Confirm(`\u4F60\u786E\u5B9A\u8981\u5220\u9664${t.categoryName}`,async()=>{!await r.Request({url:p.delCategory,params:{categoryId:t.categoryId}})||v()})},k=async(t,e)=>{let c=m.list;if(e==="down"&&t===c.length-1||e==="up"&&t===0)return;let _=c[t],u=e=="down"?1:-1;c.splice(t,1),c.splice(t+u,0,_),await r.Request({url:p.changeSort,dataType:"json",params:c})&&(r.Message.success("\u91CD\u65B0\u6392\u5E8F\u6210\u529F"),v())};return(t,e)=>{const c=s("el-button"),_=s("Cover"),u=s("el-divider"),V=s("Table"),D=s("el-input"),y=s("el-form-item"),U=s("CoverUpload"),q=s("el-form"),I=s("Dialog");return S(),L("div",null,[w.value.roleType==1?(S(),O(c,{key:0,type:"danger",onClick:e[0]||(e[0]=o=>b("add"))},{default:i(()=>[M("\u65B0\u589E\u5206\u7C7B")]),_:1})):z("",!0),a(V,{columns:R,showPagination:!1,dataSource:m,fetch:v,options:T},E({cover:i(({index:o,row:g})=>[a(_,{cover:g.cover},null,8,["cover"])]),_:2},[w.value.roleType==1?{name:"op",fn:i(({index:o,row:g})=>[d("div",A,[d("a",{href:"javascript:void(0)",class:"a-link",onClick:C=>b("update",g)},"\u4FEE\u6539",8,H),a(u,{direction:"vertical"}),d("a",{href:"javascript:void(0)",class:"a-link",onClick:C=>x(g)},"\u5220\u9664",8,P),a(u,{direction:"vertical"}),d("a",{href:"javascript:void(0)",class:B([o==0?"not-allow":"a-link"]),onClick:C=>k(o,"up")},"\u4E0A\u79FB",10,Q),a(u,{direction:"vertical"}),d("a",{href:"javascript:void(0)",class:B([o==m.list.length-1?"not-allow":"a-link"]),onClick:C=>k(o,"down")},"\u4E0B\u79FB",10,X)])]),key:"0"}:void 0]),1032,["dataSource"]),a(I,{show:n.show,title:n.title,buttons:n.buttons,width:"500px",onClose:e[4]||(e[4]=o=>n.show=!1)},{default:i(()=>[a(q,{model:l.value,rules:$,ref_key:"formDataRef",ref:f,"label-width":"80px"},{default:i(()=>[a(y,{label:"\u540D\u79F0",prop:"categoryName"},{default:i(()=>[a(D,{placeholder:"\u8BF7\u8F93\u5165\u540D\u79F0",modelValue:l.value.categoryName,"onUpdate:modelValue":e[1]||(e[1]=o=>l.value.categoryName=o)},null,8,["modelValue"])]),_:1}),a(y,{label:"\u5C01\u9762",prop:"cover"},{default:i(()=>[a(U,{modelValue:l.value.cover,"onUpdate:modelValue":e[2]||(e[2]=o=>l.value.cover=o)},null,8,["modelValue"])]),_:1}),a(y,{label:"\u7B80\u4ECB",prop:"categoryDesc"},{default:i(()=>[a(D,{modelValue:l.value.categoryDesc,"onUpdate:modelValue":e[3]||(e[3]=o=>l.value.categoryDesc=o),type:"textarea",placeholder:"\u8BF7\u8F93\u5165\u7B80\u4ECB",autosize:{minRows:4,maxRows:4}},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["show","title","buttons"])])}}};export{W as default};
